/*
 * robotino_local_move_client_node.cpp
 *
 *  Created on: 14.12.2011
 *      Author: indorewala@servicerobotics.eu
 */

#include "RobotinoLocalMoveClient.h"
#include "robotino_local_move/PathPosition.h"

#define PI 3.14159
#define MAX_TIME 60

void pathCallback(const robotino_local_move::PathPosition::ConstPtr& msg)
{
	RobotinoLocalMoveClient rlmc;
	robotino_local_move::LocalMoveGoal goal;
	goal.move_x = msg->move_x;
	goal.move_y = msg->move_y;
	goal.rotation = (msg->rotate * PI) / 180; // To radians
	rlmc.setMaxTime(MAX_TIME);

	ROS_INFO("Sending goal (move_x[m], move_y[m], rotate[deg])=(%f, %f, %f)",
			goal.move_x, goal.move_y, goal.rotation);

	if (rlmc.checkServer())
	{
		rlmc.sendGoal(goal);
		rlmc.spin();
	}
}

int main(int argc, char** argv)
{
	ros::init(argc, argv, "robotino_local_move_client_node");
	ros::NodeHandle n;
	ros::Subscriber sub = n.subscribe("path", 1000, pathCallback);

	ros::spin();	

	return 0;
}
